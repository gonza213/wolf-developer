import{Q as M,a as N,b as v,c as C,d as O}from"./QTable.f369ce6f.js";import{_ as q,bc as j,r as m,b as n,i as _,k as r,E as l,j as i,aD as k,u as R,F as U,G as g,c as w,I as V,Q as h,aB as b,as as B,ar as E,aC as T,H as D,aq as F,aU as L}from"./index.f1b44a2b.js";import{Q as S}from"./QInnerLoading.ce64e7ed.js";import{Q as A}from"./QPage.677f5366.js";import{Q as G}from"./QBadge.c5996ce2.js";import{u as z}from"./use-quasar.a96d14ef.js";import{u as I}from"./useUsuarios.4fb7e4ab.js";import{Q as H}from"./QSelect.a5bd5abf.js";import{Q as P}from"./QForm.293b32f3.js";import{c as J,a as x}from"./object.d8999c0c.js";import"./QList.8e5b8aec.js";import"./QLinearProgress.830d9759.js";import"./use-fullscreen.9d695368.js";import"./QItem.fa0fb0ff.js";import"./QItemLabel.9731a734.js";import"./QMenu.c42c600d.js";import"./selection.d049ce2b.js";const K=[{name:"nombre",required:!0,label:"Nombre",align:"left",field:d=>d.name,format:d=>`${d}`,sortable:!0},{name:"email",align:"center",label:"Email",field:"email",sortable:!0},{name:"img",label:"Img",align:"center",field:"img",sortable:!0},{name:"rol",label:"Rol",align:"center",field:"rol"},{name:"acciones",label:"Acciones",field:"acciones"}],W={emits:["onFire"],setup(d,a){const s=z(),{usuarios:o,deleteUsuario:t}=I(),u=j(),e=m(!1),f=c=>{s.dialog({title:"\xBFEst\xE1 seguro de borrar el usuario?",message:"Si no est\xE1 seguro, presione cancelar.",ok:{color:"indigo-6",label:"Si, borrar"},cancel:{color:"red-6",label:"Cancelar"},persistent:!0}).onOk(async()=>{try{const{msg:y}=await t(c);y=="ok"&&s.notify({message:"\xA1Usuario eliminado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),a.emit("onFire",!1)}catch(y){console.log(y)}})};return{filter:m(""),columns:K,usuarios:o,onDelete:f,visible:e,onEdit:c=>{u.push(`usuarios/edit/${c}`)}}}},X={class:"col-12"},Y={class:"q-pa-md"},Z=i("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png"},null,-1),$=["src"],oo={class:"row justify-center"};function eo(d,a,s,o,t,u){return n(),_("div",X,[r(B,{class:"my-card bg-white"},{default:l(()=>[i("div",Y,[r(M,{title:"Lista de Usuarios",rows:o.usuarios,columns:o.columns,"row-key":"name",filter:o.filter},{"top-right":l(()=>[r(k,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":a[0]||(a[0]=e=>o.filter=e),placeholder:"Buscar",color:"indigo-6"},{append:l(()=>[r(R,{name:"search"})]),_:1},8,["modelValue"])]),body:l(e=>[r(N,{props:e},{default:l(()=>[r(v,{key:"nombre",props:e},{default:l(()=>[U(g(e.row.nombre),1)]),_:2},1032,["props"]),r(v,{key:"email",props:e},{default:l(()=>[U(g(e.row.email),1)]),_:2},1032,["props"]),r(v,{key:"img",props:e},{default:l(()=>[e.row.img?(n(),w(V,{key:1},{default:l(()=>[i("img",{src:e.row.img},null,8,$)]),_:2},1024)):(n(),w(V,{key:0},{default:l(()=>[Z]),_:1}))]),_:2},1032,["props"]),r(v,{key:"rol",props:e},{default:l(()=>[r(G,{color:"grey-6"},{default:l(()=>[U(g(e.row.rol),1)]),_:2},1024)]),_:2},1032,["props"]),r(v,{key:"acciones",props:e},{default:l(()=>[r(h,{round:"",color:"orange-4",size:"sm",icon:"las la-edit",onClick:f=>o.onEdit(e.row.uid)},null,8,["onClick"]),e.row.email!=="gonzaa.vidal.18@gmail.com"?(n(),w(h,{key:0,round:"",color:"red-4",size:"sm",icon:"las la-trash",class:"q-ml-xs",onClick:f=>o.onDelete(e.row.uid)},null,8,["onClick"])):b("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),i("div",oo,[r(S,{showing:o.visible,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])])]),_:1})])}var ro=q(W,[["render",eo]]);const ao={emits:["onFire"],setup(d,a){const s=m({nombre:"",email:"",password:"",rol:""});let o=m({});const t=m(),u=z(),e=m(!1),f=J().shape({rol:x().required("El rol es obligatorio."),password:x().required("La contrase\xF1a es obligatoria."),email:x().email("El email es inv\xE1lido.").required("El email es obligatorio."),nombre:x().required("El nombre es obligatorio.")}),{createUsuario:c}=I();return{formData:s,formError:o,msgError:t,onSubmit:async()=>{o.value={};try{await f.validate(s.value,{abortEarly:!1});try{e.value=!0,u.loadingBar.start();const{msg:p}=await c(s.value);p=="ok"&&(u.notify({message:"\xA1Usuario creado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),s.value={},t.value="",u.loadingBar.stop()),e.value=!1,a.emit("onFire",!1)}catch(p){console.log(p)}}catch(p){p.inner.forEach(Q=>{o.value[Q.path]=Q.message,t.value=o.value[Q.path]})}},options:["ADMIN_ROLE","USER_ROLE"],loading:e}}},lo={class:"q-gutter-md"},so={key:0,class:"q-mx-lg text-red-6 text-weight-bold"},io={key:1,class:"q-mx-lg text-red-6 text-weight-bold"},to={key:2,class:"q-mx-lg text-red-6 text-weight-bold"},no={key:3,class:"q-mx-lg text-red-6 text-weight-bold"},co={class:"row justify-end"};function mo(d,a,s,o,t,u){return n(),_("div",lo,[r(P,{class:"q-gutter-md",onSubmit:T(o.onSubmit,["prevent"])},{default:l(()=>[r(k,{filled:"",modelValue:o.formData.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>o.formData.nombre=e),label:"Nombre completo",color:"indigo-6",class:E({error:o.formError.nombre})},null,8,["modelValue","class"]),o.formError.nombre?(n(),_("span",so,g(o.formError.nombre),1)):b("",!0),r(k,{filled:"",modelValue:o.formData.email,"onUpdate:modelValue":a[1]||(a[1]=e=>o.formData.email=e),label:"Correo electr\xF3nico",color:"indigo-6",class:E({error:o.formError.email})},null,8,["modelValue","class"]),o.formError.email?(n(),_("span",io,g(o.formError.email),1)):b("",!0),r(k,{filled:"",modelValue:o.formData.password,"onUpdate:modelValue":a[2]||(a[2]=e=>o.formData.password=e),type:"password",label:"Contrase\xF1a",color:"indigo-6",class:E({error:o.formError.password})},null,8,["modelValue","class"]),o.formError.password?(n(),_("span",to,g(o.formError.password),1)):b("",!0),r(H,{filled:"",modelValue:o.formData.rol,"onUpdate:modelValue":a[3]||(a[3]=e=>o.formData.rol=e),options:o.options,label:"Rol",color:"indigo-6",class:E({error:o.formError.rol})},null,8,["modelValue","options","class"]),o.formError.rol?(n(),_("span",no,g(o.formError.rol),1)):b("",!0),i("div",co,[r(h,{type:"submit",color:"indigo-6",label:"Crear",class:"self-center q-ma-sm q-py-sm","icon-right":"las la-user-plus",loading:o.loading},null,8,["loading"])])]),_:1},8,["onSubmit"])])}var uo=q(ao,[["render",mo],["__scopeId","data-v-7c8dee1c"]]);const fo={components:{Usuarios:ro,CrearUsuario:uo},setup(){const d=m(!1),a=m(!0),s=m(!1);return{showModal:d,visible:a,visible2:s,onFire:t=>{a.value=t,s.value=!0,setTimeout(()=>{a.value=!0},1e3),setTimeout(()=>{s.value=t},2e3)}}}},go={class:"q-pa-md q-gutter-sm text-indigo-6"},_o={class:"row"},bo={class:"col-12 row q-pa-sm"},po=i("div",{class:"col-6 text-indigo-6"},[i("span",{class:"text-h3 text-weight-bold"},"Usuarios")],-1),vo={class:"col-6 row justify-end"},wo={class:"row justify-center"},ho=i("div",{class:"text-h5 col-8"},"Crear Usuario",-1),yo={class:"text-h5 col-4 row justify-end"};function Eo(d,a,s,o,t,u){const e=D("Usuarios"),f=D("CrearUsuario");return n(),w(A,{class:"q-pa-md bg-white"},{default:l(()=>[i("div",go,[r(O,null,{default:l(()=>[r(C,{icon:"home",to:{name:"home"}}),r(C,{label:"Usuarios",icon:"las la-users"})]),_:1})]),i("div",_o,[i("div",bo,[po,i("div",vo,[r(h,{color:"indigo-6",icon:"las la-user-plus",onClick:a[0]||(a[0]=c=>o.showModal=!0),size:"md",rounded:""})])]),o.visible?(n(),w(e,{key:0,onOnFire:o.onFire},null,8,["onOnFire"])):b("",!0),i("div",wo,[r(S,{showing:o.visible2,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])]),r(L,{modelValue:o.showModal,"onUpdate:modelValue":a[2]||(a[2]=c=>o.showModal=c)},{default:l(()=>[r(B,{class:"q-dialog-plugin"},{default:l(()=>[r(F,{class:"row"},{default:l(()=>[ho,i("div",yo,[r(h,{rounded:"",icon:"las la-times",size:"sm",onClick:a[1]||(a[1]=c=>o.showModal=!1),color:"indigo-6"})])]),_:1}),r(F,null,{default:l(()=>[r(f,{onOnFire:o.onFire},null,8,["onOnFire"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ro=q(fo,[["render",Eo]]);export{Ro as default};
