import{Q as S}from"./QPage.4e78f95d.js";import{_ as Q,r as k,o as C,b as s,c as f,E as r,k as t,aE as x,as as P,i as v,G as h,aC as m,aq as A,j as c,Q as g,aD as z,at as $,aY as N,K as j,F as q,bn as D,H as E}from"./index.a4028430.js";import{Q as V}from"./QSelect.a21455d6.js";import{Q as T}from"./QForm.48f32ff2.js";import{u as U}from"./use-quasar.e29676f0.js";import{c as B,a as w}from"./object.d8999c0c.js";import{u as L,a as R}from"./usePortafolios.1ec294c1.js";import{Q as M}from"./QInnerLoading.168e57cb.js";import{Q as y,a as G,b as H,A as K}from"./constants.7d5a3cca.js";import"./QItem.7e8b8d1c.js";import"./QItemLabel.afc12c08.js";import"./QMenu.ac8c1059.js";import"./selection.ca895cee.js";const Y={key:0,class:"q-mx-lg text-red-6 text-weight-bold"},J={key:1,class:"q-mx-lg text-red-6 text-weight-bold"},O={key:2,class:"q-mx-lg text-red-6 text-weight-bold"},W={class:"row justify-end"},X={__name:"EditarPortafolioComponent",props:["id","portafolio","editPortafolio"],setup(b){const n=b,e=k({}),o=k({}),p=k(!1),u=U(),_=B().shape({titulo:w().required("El titulo no puede estar vacio."),categoria:w().required("Debe seleccionar una categoria."),descripcion:w().min(10,"Al menos debe tener 10 caracteres").required("Debe ingresar una descripci\xF3n.")}),{categorias:l}=L();C(async()=>{const{portafolio:a}=await n.portafolio(n.id);a.recomedar==!0?a.recomedar={label:"Si",value:a.recomedar}:a.recomedar={label:"No",value:a.recomedar},e.value={titulo:a.titulo,descripcion:a.descripcion,enlace:a.enlace,recomedar:a.recomedar,categoria:{label:a.categoria.nombre,value:a.categoria._id}}});const I=async()=>{o.value={};const a={titulo:e.value.titulo,descripcion:e.value.descripcion,enlace:e.value.enlace,recomedar:e.value.recomedar.value,categoria:e.value.categoria.value};a.enlace||delete a.enlace,a.recomedar===""&&delete a.recomedar;try{await _.validate(a,{abortEarly:!1});try{p.value=!0;const{msg:i}=await n.editPortafolio(n.id,a);i=="ok"&&u.notify({message:"\xA1Portafolio actualizado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),p.value=!1}catch(i){console.log(i)}}catch(i){i.inner.forEach(d=>{o.value[d.path]=d.message})}},F=[{label:"Si",value:!0},{label:"No",value:!1}];return(a,i)=>(s(),f($,{class:"q-pa-md"},{default:r(()=>[t(T,{class:"q-gutter-md",onSubmit:z(I,["prevent"])},{default:r(()=>[t(x,{filled:"",label:"Titulo",modelValue:e.value.titulo,"onUpdate:modelValue":i[0]||(i[0]=d=>e.value.titulo=d),color:"indigo-6",class:P({error:o.value.titulo})},null,8,["modelValue","class"]),o.value.titulo?(s(),v("span",Y,h(o.value.titulo),1)):m("",!0),t(V,{filled:"",label:"Categoria",options:A(l),modelValue:e.value.categoria,"onUpdate:modelValue":i[1]||(i[1]=d=>e.value.categoria=d),color:"indigo-6",class:P({error:o.value.categoria})},null,8,["options","modelValue","class"]),o.value.categorias?(s(),v("span",J,h(o.value.categorias),1)):m("",!0),t(x,{filled:"",label:"Enlace",modelValue:e.value.enlace,"onUpdate:modelValue":i[2]||(i[2]=d=>e.value.enlace=d),color:"indigo-6"},null,8,["modelValue"]),t(V,{filled:"",label:"Recomendar",options:F,modelValue:e.value.recomedar,"onUpdate:modelValue":i[3]||(i[3]=d=>e.value.recomedar=d),color:"indigo-6"},null,8,["modelValue"]),t(x,{filled:"",label:"Descripci\xF3n",type:"textarea",modelValue:e.value.descripcion,"onUpdate:modelValue":i[4]||(i[4]=d=>e.value.descripcion=d),color:"indigo-6",class:P({error:o.value.descripcion})},null,8,["modelValue","class"]),o.value.descripcion?(s(),v("span",O,h(o.value.descripcion),1)):m("",!0),c("div",W,[t(g,{type:"submit",color:"indigo-6",label:"Actualizar",class:"self-center q-ma-sm q-py-sm","icon-right":"las la-cube",loading:p.value},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1}))}};var Z=Q(X,[["__scopeId","data-v-1e25f2c4"]]);const ee={class:"justify-center row"},oe=["loading"],ae=["src"],te={class:"row justify-center"},le={class:"row no-wrap items-center q-pa-sm q-gutter-xs"},ie=q("Limpiar"),re=q("Remover archivo"),se={class:"col"},ne=c("div",{class:"q-uploader__title"},"Actualizar Imagen",-1),de={class:"q-uploader__subtitle"},ce=q("Elegir Archivo"),ue=q("Subir archivo"),me=q("Abortar"),pe={__name:"EditarImgComponent",props:["id","portafolio"],setup(b){const n=b,e=k(),o=U();C(async()=>{const{portafolio:u}=await n.portafolio(n.id);e.value=u.img});const p=u=>new Promise(_=>{setTimeout(()=>{_({url:`${K}/api/uploads/portafolios/${n.id}`,method:"PUT",fieldName:"archivo"}),o.notify({message:"\xA1Imagen actualizada con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"})},2e3)});return(u,_)=>(s(),v(j,null,[t($,{class:"q-mb-md"},{default:r(()=>[c("div",ee,[e.value?(s(),v("img",{key:1,src:e.value,class:"q-pa-sm",style:{width:"300px",height:"200px"}},null,8,ae)):(s(),v("img",{key:0,src:"https://cdn.quasar.dev/img/boy-avatar.png",class:"q-pa-sm",style:{width:"200px"},loading:u.loading},null,8,oe))]),c("div",te,[t(M,{showing:u.loading,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])]),_:1}),t(H,{style:{width:"100%"},label:"Cambiar foto",accept:".jpg, image/*",factory:p,color:"indigo-6"},{header:r(l=>[c("div",le,[l.queuedFiles.length>0?(s(),f(g,{key:0,icon:"clear_all",onClick:l.removeQueuedFiles,round:"",dense:"",flat:""},{default:r(()=>[t(y,null,{default:r(()=>[ie]),_:1})]),_:2},1032,["onClick"])):m("",!0),l.uploadedFiles.length>0?(s(),f(g,{key:1,icon:"done_all",onClick:l.removeUploadedFiles,round:"",dense:"",flat:""},{default:r(()=>[t(y,null,{default:r(()=>[re]),_:1})]),_:2},1032,["onClick"])):m("",!0),l.isUploading?(s(),f(N,{key:2,class:"q-uploader__spinner"})):m("",!0),c("div",se,[ne,c("div",de,h(l.uploadSizeLabel)+" / "+h(l.uploadProgressLabel),1)]),l.canAddFiles?(s(),f(g,{key:3,type:"a",icon:"add_box",onClick:l.pickFiles,round:"",dense:"",flat:""},{default:r(()=>[t(G),t(y,null,{default:r(()=>[ce]),_:1})]),_:2},1032,["onClick"])):m("",!0),l.canUpload?(s(),f(g,{key:4,icon:"las la-upload",onClick:l.upload,round:"",dense:"",color:"dark"},{default:r(()=>[t(y,null,{default:r(()=>[ue]),_:1})]),_:2},1032,["onClick"])):m("",!0),l.isUploading?(s(),f(g,{key:5,icon:"clear",onClick:l.abort,round:"",dense:"",flat:""},{default:r(()=>[t(y,null,{default:r(()=>[me]),_:1})]),_:2},1032,["onClick"])):m("",!0)])]),_:1})],64))}},fe={components:{EditPortafolio:Z,EditImgPortafolio:pe},setup(){const n=D().params.id,e=k(),{getPortafolio:o,editPortafolio:p}=R();return C(async()=>{const{portafolio:u}=await o(n);e.value=u.titulo}),{id:n,getPortafolio:o,editPortafolio:p,titulo:e}}},_e={class:"row justify-center"},ge={class:"col-12"},ve={class:"text-h4 text-dark"},he={class:"col-12 col-md-4 q-ma-md"},be={class:"col-12 col-md-6 q-ma-md"};function ye(b,n,e,o,p,u){const _=E("EditImgPortafolio"),l=E("EditPortafolio");return s(),f(S,{class:"q-pa-md bg-white"},{default:r(()=>[c("div",_e,[c("div",ge,[c("span",ve,h(o.titulo),1)]),c("div",he,[t(_,{id:o.id,portafolio:o.getPortafolio},null,8,["id","portafolio"])]),c("div",be,[t(l,{id:o.id,portafolio:o.getPortafolio,editPortafolio:o.editPortafolio},null,8,["id","portafolio","editPortafolio"])])])]),_:1})}var Se=Q(fe,[["render",ye]]);export{Se as default};
