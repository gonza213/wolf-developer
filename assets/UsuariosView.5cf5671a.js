import{Q as I,a as M,b as v,c as q,d as N}from"./QTable.30a79c6a.js";import{_ as U,bc as O,r as c,e as n,j as _,l as r,F as l,k as t,aD as k,v as j,G as Q,H as g,f as h,J as V,Q as w,aB as b,at as F,aC as R,I as C,ar as D,aU as T}from"./index.29806dde.js";import{Q as B}from"./QInnerLoading.f8ef1d37.js";import{Q as L}from"./QPage.00dc6b8f.js";import{Q as A}from"./QBadge.416d7341.js";import{u as S}from"./use-quasar.150d19b7.js";import{u as z}from"./useUsuarios.344c6ef0.js";import{Q as G}from"./QSelect.62f6c531.js";import{Q as H}from"./QForm.b87600b7.js";import{c as J,a as x}from"./object.d8999c0c.js";import"./QList.f8bdf586.js";import"./QLinearProgress.b85c3e56.js";import"./use-fullscreen.ba5db9bb.js";import"./constants.9e8d69f8.js";import"./QItem.c9fc7e41.js";import"./QItemLabel.4153c487.js";import"./QMenu.8a8d383d.js";import"./selection.2499a8e5.js";const P=[{name:"nombre",required:!0,label:"Nombre",align:"left",field:d=>d.name,format:d=>`${d}`,sortable:!0},{name:"email",align:"center",label:"Email",field:"email",sortable:!0},{name:"img",label:"Img",align:"center",field:"img",sortable:!0},{name:"rol",label:"Rol",align:"center",field:"rol"},{name:"acciones",label:"Acciones",field:"acciones"}],$={emits:["onFire"],setup(d,a){const s=S(),{usuarios:o,deleteUsuario:i}=z(),u=O(),e=c(!1),f=m=>{s.dialog({title:"\xBFEst\xE1 seguro de borrar el usuario?",message:"Si no est\xE1 seguro, presione cancelar.",ok:{color:"indigo-6",label:"Si, borrar"},cancel:{color:"red-6",label:"Cancelar"},persistent:!0}).onOk(async()=>{try{const{msg:y}=await i(m);y=="ok"&&s.notify({message:"\xA1Usuario eliminado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),a.emit("onFire",!1)}catch(y){console.log(y)}})};return{filter:c(""),columns:P,usuarios:o,onDelete:f,visible:e,onEdit:m=>{u.push(`usuarios/edit/${m}`)}}}},K={class:"col-12"},W={class:"q-pa-md"},X=t("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png"},null,-1),Y=["src"],Z={class:"row justify-center"};function oo(d,a,s,o,i,u){return n(),_("div",K,[r(F,{class:"my-card bg-white"},{default:l(()=>[t("div",W,[r(I,{title:"Lista de Usuarios",rows:o.usuarios,columns:o.columns,"row-key":"name",filter:o.filter},{"top-right":l(()=>[r(k,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":a[0]||(a[0]=e=>o.filter=e),placeholder:"Buscar",color:"indigo-6"},{append:l(()=>[r(j,{name:"search"})]),_:1},8,["modelValue"])]),body:l(e=>[r(M,{props:e},{default:l(()=>[r(v,{key:"nombre",props:e},{default:l(()=>[Q(g(e.row.nombre),1)]),_:2},1032,["props"]),r(v,{key:"email",props:e},{default:l(()=>[Q(g(e.row.email),1)]),_:2},1032,["props"]),r(v,{key:"img",props:e},{default:l(()=>[e.row.img?(n(),h(V,{key:1},{default:l(()=>[t("img",{src:e.row.img},null,8,Y)]),_:2},1024)):(n(),h(V,{key:0},{default:l(()=>[X]),_:1}))]),_:2},1032,["props"]),r(v,{key:"rol",props:e},{default:l(()=>[r(A,{color:"grey-6"},{default:l(()=>[Q(g(e.row.rol),1)]),_:2},1024)]),_:2},1032,["props"]),r(v,{key:"acciones",props:e},{default:l(()=>[r(w,{round:"",color:"orange-4",size:"sm",icon:"las la-edit",onClick:f=>o.onEdit(e.row.uid)},null,8,["onClick"]),e.row.email!=="gonzaa.vidal.18@gmail.com"?(n(),h(w,{key:0,round:"",color:"red-4",size:"sm",icon:"las la-trash",class:"q-ml-xs",onClick:f=>o.onDelete(e.row.uid)},null,8,["onClick"])):b("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),t("div",Z,[r(B,{showing:o.visible,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])])]),_:1})])}var eo=U($,[["render",oo]]);const ro={emits:["onFire"],setup(d,a){const s=c({nombre:"",email:"",password:"",rol:""});let o=c({});const i=c(),u=S(),e=c(!1),f=J().shape({rol:x().required("El rol es obligatorio."),password:x().required("La contrase\xF1a es obligatoria."),email:x().email("El email es inv\xE1lido.").required("El email es obligatorio."),nombre:x().required("El nombre es obligatorio.")}),{createUsuario:m}=z();return{formData:s,formError:o,msgError:i,onSubmit:async()=>{o.value={};try{await f.validate(s.value,{abortEarly:!1});try{e.value=!0,u.loadingBar.start();const{msg:p}=await m(s.value);p=="ok"&&(u.notify({message:"\xA1Usuario creado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),s.value={},i.value="",u.loadingBar.stop()),e.value=!1,a.emit("onFire",!1)}catch(p){console.log(p)}}catch(p){p.inner.forEach(E=>{o.value[E.path]=E.message,i.value=o.value[E.path]})}},options:["ADMIN_ROLE","USER_ROLE"],loading:e}}},ao={class:"q-gutter-md"},lo={key:0,class:"q-mx-lg text-red-6 text-weight-bold"},so={key:1,class:"q-mx-lg text-red-6 text-weight-bold"},to={key:2,class:"q-mx-lg text-red-6 text-weight-bold"},io={key:3,class:"q-mx-lg text-red-6 text-weight-bold"},no={class:"row justify-end"};function mo(d,a,s,o,i,u){return n(),_("div",ao,[r(H,{class:"q-gutter-md",onSubmit:R(o.onSubmit,["prevent"])},{default:l(()=>[r(k,{filled:"",modelValue:o.formData.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>o.formData.nombre=e),label:"Nombre completo",color:"indigo-6"},null,8,["modelValue"]),o.formError.nombre?(n(),_("span",lo,g(o.formError.nombre),1)):b("",!0),r(k,{filled:"",modelValue:o.formData.email,"onUpdate:modelValue":a[1]||(a[1]=e=>o.formData.email=e),label:"Correo electr\xF3nico",color:"indigo-6"},null,8,["modelValue"]),o.formError.email?(n(),_("span",so,g(o.formError.email),1)):b("",!0),r(k,{filled:"",modelValue:o.formData.password,"onUpdate:modelValue":a[2]||(a[2]=e=>o.formData.password=e),type:"password",label:"Contrase\xF1a",color:"indigo-6"},null,8,["modelValue"]),o.formError.password?(n(),_("span",to,g(o.formError.password),1)):b("",!0),r(G,{filled:"",modelValue:o.formData.rol,"onUpdate:modelValue":a[3]||(a[3]=e=>o.formData.rol=e),options:o.options,label:"Rol",color:"indigo-6"},null,8,["modelValue","options"]),o.formError.rol?(n(),_("span",io,g(o.formError.rol),1)):b("",!0),t("div",no,[r(w,{type:"submit",color:"indigo-6",label:"Crear",class:"self-center q-ma-sm q-py-sm","icon-right":"las la-user-plus",loading:o.loading},null,8,["loading"])])]),_:1},8,["onSubmit"])])}var co=U(ro,[["render",mo],["__scopeId","data-v-2aceeff1"]]);const uo={components:{Usuarios:eo,CrearUsuario:co},setup(){const d=c(!1),a=c(!0),s=c(!1);return{showModal:d,visible:a,visible2:s,onFire:i=>{a.value=i,s.value=!0,setTimeout(()=>{a.value=!0},1e3),setTimeout(()=>{s.value=i},2e3)}}}},fo={class:"q-pa-md q-gutter-sm text-indigo-6"},go={class:"row"},_o={class:"col-12 row q-pa-sm"},bo=t("div",{class:"col-6 text-indigo-6"},[t("span",{class:"text-h3 text-weight-bold"},"Usuarios")],-1),po={class:"col-6 row justify-end"},vo={class:"row justify-center"},ho=t("div",{class:"text-h5 col-8"},"Crear Usuario",-1),wo={class:"text-h5 col-4 row justify-end"};function yo(d,a,s,o,i,u){const e=C("Usuarios"),f=C("CrearUsuario");return n(),h(L,{class:"q-pa-md bg-white"},{default:l(()=>[t("div",fo,[r(N,null,{default:l(()=>[r(q,{icon:"home",to:{name:"home"}}),r(q,{label:"Usuarios",icon:"las la-users"})]),_:1})]),t("div",go,[t("div",_o,[bo,t("div",po,[r(w,{color:"indigo-6",icon:"las la-user-plus",onClick:a[0]||(a[0]=m=>o.showModal=!0),size:"md",rounded:""})])]),o.visible?(n(),h(e,{key:0,onOnFire:o.onFire},null,8,["onOnFire"])):b("",!0),t("div",vo,[r(B,{showing:o.visible2,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])]),r(T,{modelValue:o.showModal,"onUpdate:modelValue":a[2]||(a[2]=m=>o.showModal=m)},{default:l(()=>[r(F,{class:"q-dialog-plugin"},{default:l(()=>[r(D,{class:"row"},{default:l(()=>[ho,t("div",wo,[r(w,{rounded:"",icon:"las la-times",size:"sm",onClick:a[1]||(a[1]=m=>o.showModal=!1),color:"indigo-6"})])]),_:1}),r(D,null,{default:l(()=>[r(f,{onOnFire:o.onFire},null,8,["onOnFire"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ro=U(uo,[["render",yo]]);export{Ro as default};
