import{Q as M,a as N,b as v,c as C,d as O}from"./QTable.11e4f287.js";import{_ as q,bc as j,r as c,e as n,j as _,l as r,F as l,k as i,aD as k,v as R,G as U,H as g,f as w,J as V,Q as h,aB as b,at as B,as as x,aC as T,I as D,ar as F,aU as L}from"./index.71b3f425.js";import{Q as S}from"./QInnerLoading.7e2815cc.js";import{Q as A}from"./QPage.f7937440.js";import{Q as G}from"./QBadge.e341da73.js";import{u as z}from"./use-quasar.bb0955e5.js";import{u as I}from"./useUsuarios.152715b2.js";import{Q as H}from"./QSelect.209267a6.js";import{Q as J}from"./QForm.7e7073e1.js";import{c as P,a as E}from"./object.d8999c0c.js";import"./QList.d66e8cc1.js";import"./QLinearProgress.28e49b30.js";import"./use-fullscreen.eabd274e.js";import"./constants.9e8d69f8.js";import"./QItem.3de04644.js";import"./QItemLabel.766e1532.js";import"./QMenu.24e58f5c.js";import"./selection.025d28b3.js";const K=[{name:"nombre",required:!0,label:"Nombre",align:"left",field:d=>d.name,format:d=>`${d}`,sortable:!0},{name:"email",align:"center",label:"Email",field:"email",sortable:!0},{name:"img",label:"Img",align:"center",field:"img",sortable:!0},{name:"rol",label:"Rol",align:"center",field:"rol"},{name:"acciones",label:"Acciones",field:"acciones"}],W={emits:["onFire"],setup(d,a){const s=z(),{usuarios:o,deleteUsuario:t}=I(),u=j(),e=c(!1),f=m=>{s.dialog({title:"\xBFEst\xE1 seguro de borrar el usuario?",message:"Si no est\xE1 seguro, presione cancelar.",ok:{color:"indigo-6",label:"Si, borrar"},cancel:{color:"red-6",label:"Cancelar"},persistent:!0}).onOk(async()=>{try{const{msg:y}=await t(m);y=="ok"&&s.notify({message:"\xA1Usuario eliminado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),a.emit("onFire",!1)}catch(y){console.log(y)}})};return{filter:c(""),columns:K,usuarios:o,onDelete:f,visible:e,onEdit:m=>{u.push(`usuarios/edit/${m}`)}}}},X={class:"col-12"},Y={class:"q-pa-md"},Z=i("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png"},null,-1),$=["src"],oo={class:"row justify-center"};function eo(d,a,s,o,t,u){return n(),_("div",X,[r(B,{class:"my-card bg-white"},{default:l(()=>[i("div",Y,[r(M,{title:"Lista de Usuarios",rows:o.usuarios,columns:o.columns,"row-key":"name",filter:o.filter},{"top-right":l(()=>[r(k,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":a[0]||(a[0]=e=>o.filter=e),placeholder:"Buscar",color:"indigo-6"},{append:l(()=>[r(R,{name:"search"})]),_:1},8,["modelValue"])]),body:l(e=>[r(N,{props:e},{default:l(()=>[r(v,{key:"nombre",props:e},{default:l(()=>[U(g(e.row.nombre),1)]),_:2},1032,["props"]),r(v,{key:"email",props:e},{default:l(()=>[U(g(e.row.email),1)]),_:2},1032,["props"]),r(v,{key:"img",props:e},{default:l(()=>[e.row.img?(n(),w(V,{key:1},{default:l(()=>[i("img",{src:e.row.img},null,8,$)]),_:2},1024)):(n(),w(V,{key:0},{default:l(()=>[Z]),_:1}))]),_:2},1032,["props"]),r(v,{key:"rol",props:e},{default:l(()=>[r(G,{color:"grey-6"},{default:l(()=>[U(g(e.row.rol),1)]),_:2},1024)]),_:2},1032,["props"]),r(v,{key:"acciones",props:e},{default:l(()=>[r(h,{round:"",color:"orange-4",size:"sm",icon:"las la-edit",onClick:f=>o.onEdit(e.row.uid)},null,8,["onClick"]),e.row.email!=="gonzaa.vidal.18@gmail.com"?(n(),w(h,{key:0,round:"",color:"red-4",size:"sm",icon:"las la-trash",class:"q-ml-xs",onClick:f=>o.onDelete(e.row.uid)},null,8,["onClick"])):b("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),i("div",oo,[r(S,{showing:o.visible,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])])]),_:1})])}var ro=q(W,[["render",eo]]);const ao={emits:["onFire"],setup(d,a){const s=c({nombre:"",email:"",password:"",rol:""});let o=c({});const t=c(),u=z(),e=c(!1),f=P().shape({rol:E().required("El rol es obligatorio."),password:E().required("La contrase\xF1a es obligatoria."),email:E().email("El email es inv\xE1lido.").required("El email es obligatorio."),nombre:E().required("El nombre es obligatorio.")}),{createUsuario:m}=I();return{formData:s,formError:o,msgError:t,onSubmit:async()=>{o.value={};try{await f.validate(s.value,{abortEarly:!1});try{e.value=!0,u.loadingBar.start();const{msg:p}=await m(s.value);p=="ok"&&(u.notify({message:"\xA1Usuario creado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),s.value={},t.value="",u.loadingBar.stop()),e.value=!1,a.emit("onFire",!1)}catch(p){console.log(p)}}catch(p){p.inner.forEach(Q=>{o.value[Q.path]=Q.message,t.value=o.value[Q.path]})}},options:["ADMIN_ROLE","USER_ROLE"],loading:e}}},lo={class:"q-gutter-md"},so={key:0,class:"q-mx-lg text-red-6 text-weight-bold"},io={key:1,class:"q-mx-lg text-red-6 text-weight-bold"},to={key:2,class:"q-mx-lg text-red-6 text-weight-bold"},no={key:3,class:"q-mx-lg text-red-6 text-weight-bold"},mo={class:"row justify-end"};function co(d,a,s,o,t,u){return n(),_("div",lo,[r(J,{class:"q-gutter-md",onSubmit:T(o.onSubmit,["prevent"])},{default:l(()=>[r(k,{filled:"",modelValue:o.formData.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>o.formData.nombre=e),label:"Nombre completo",color:"indigo-6",class:x({error:o.formError.nombre})},null,8,["modelValue","class"]),o.formError.nombre?(n(),_("span",so,g(o.formError.nombre),1)):b("",!0),r(k,{filled:"",modelValue:o.formData.email,"onUpdate:modelValue":a[1]||(a[1]=e=>o.formData.email=e),label:"Correo electr\xF3nico",color:"indigo-6",class:x({error:o.formError.email})},null,8,["modelValue","class"]),o.formError.email?(n(),_("span",io,g(o.formError.email),1)):b("",!0),r(k,{filled:"",modelValue:o.formData.password,"onUpdate:modelValue":a[2]||(a[2]=e=>o.formData.password=e),type:"password",label:"Contrase\xF1a",color:"indigo-6",class:x({error:o.formError.password})},null,8,["modelValue","class"]),o.formError.password?(n(),_("span",to,g(o.formError.password),1)):b("",!0),r(H,{filled:"",modelValue:o.formData.rol,"onUpdate:modelValue":a[3]||(a[3]=e=>o.formData.rol=e),options:o.options,label:"Rol",color:"indigo-6",class:x({error:o.formError.rol})},null,8,["modelValue","options","class"]),o.formError.rol?(n(),_("span",no,g(o.formError.rol),1)):b("",!0),i("div",mo,[r(h,{type:"submit",color:"indigo-6",label:"Crear",class:"self-center q-ma-sm q-py-sm","icon-right":"las la-user-plus",loading:o.loading},null,8,["loading"])])]),_:1},8,["onSubmit"])])}var uo=q(ao,[["render",co],["__scopeId","data-v-7c8dee1c"]]);const fo={components:{Usuarios:ro,CrearUsuario:uo},setup(){const d=c(!1),a=c(!0),s=c(!1);return{showModal:d,visible:a,visible2:s,onFire:t=>{a.value=t,s.value=!0,setTimeout(()=>{a.value=!0},1e3),setTimeout(()=>{s.value=t},2e3)}}}},go={class:"q-pa-md q-gutter-sm text-indigo-6"},_o={class:"row"},bo={class:"col-12 row q-pa-sm"},po=i("div",{class:"col-6 text-indigo-6"},[i("span",{class:"text-h3 text-weight-bold"},"Usuarios")],-1),vo={class:"col-6 row justify-end"},wo={class:"row justify-center"},ho=i("div",{class:"text-h5 col-8"},"Crear Usuario",-1),yo={class:"text-h5 col-4 row justify-end"};function xo(d,a,s,o,t,u){const e=D("Usuarios"),f=D("CrearUsuario");return n(),w(A,{class:"q-pa-md bg-white"},{default:l(()=>[i("div",go,[r(O,null,{default:l(()=>[r(C,{icon:"home",to:{name:"home"}}),r(C,{label:"Usuarios",icon:"las la-users"})]),_:1})]),i("div",_o,[i("div",bo,[po,i("div",vo,[r(h,{color:"indigo-6",icon:"las la-user-plus",onClick:a[0]||(a[0]=m=>o.showModal=!0),size:"md",rounded:""})])]),o.visible?(n(),w(e,{key:0,onOnFire:o.onFire},null,8,["onOnFire"])):b("",!0),i("div",wo,[r(S,{showing:o.visible2,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])]),r(L,{modelValue:o.showModal,"onUpdate:modelValue":a[2]||(a[2]=m=>o.showModal=m)},{default:l(()=>[r(B,{class:"q-dialog-plugin"},{default:l(()=>[r(F,{class:"row"},{default:l(()=>[ho,i("div",yo,[r(h,{rounded:"",icon:"las la-times",size:"sm",onClick:a[1]||(a[1]=m=>o.showModal=!1),color:"indigo-6"})])]),_:1}),r(F,null,{default:l(()=>[r(f,{onOnFire:o.onFire},null,8,["onOnFire"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var To=q(fo,[["render",xo]]);export{To as default};
