import{Q as D,a as R,b as h,c as E,d as T}from"./QTable.b61c2387.js";import{bd as L,r as m,b as u,i as b,k as e,E as l,j as i,aq as n,aE as q,u as O,F as $,G as f,c as y,I as B,Q as x,aC as v,at as S,_ as A,as as k,aD as M,ar as F,aV as G}from"./index.578b6eaa.js";import{Q as z}from"./QInnerLoading.c97a4a11.js";import{Q as P}from"./QPage.f2da26dc.js";import{Q as H}from"./QBadge.b8be4b8e.js";import{u as I}from"./use-quasar.cb08f239.js";import{u as N}from"./useUsuarios.a0710e8b.js";import{Q as J}from"./QSelect.05d4726a.js";import{Q as K}from"./QForm.84a00b48.js";import{c as W,a as Q}from"./object.d8999c0c.js";import"./QList.c56f6413.js";import"./QLinearProgress.dad89e6b.js";import"./use-fullscreen.bccdc1be.js";import"./QItem.56a6dcfa.js";import"./QItemLabel.b0a535a9.js";import"./QMenu.338ffc70.js";import"./selection.c86d2b2b.js";const X={class:"col-12"},Y={class:"q-pa-md"},Z=i("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png"},null,-1),ee=["src"],oe={class:"row justify-center"},ae={__name:"UsuariosComponent",emits:["onFire"],setup(U,{emit:p}){const r=[{name:"nombre",required:!0,label:"Nombre",align:"left",field:t=>t.name,format:t=>`${t}`,sortable:!0},{name:"email",align:"center",label:"Email",field:"email",sortable:!0},{name:"img",label:"Img",align:"center",field:"img",sortable:!0},{name:"rol",label:"Rol",align:"center",field:"rol"},{name:"acciones",label:"Acciones",field:"acciones"}],a=I(),{usuarios:g,deleteUsuario:c}=N(),d=L(),_=m(!1),w=m(""),V=t=>{a.dialog({title:"\xBFEst\xE1 seguro de borrar el usuario?",message:"Si no est\xE1 seguro, presione cancelar.",ok:{color:"indigo-6",label:"Si, borrar"},cancel:{color:"red-6",label:"Cancelar"},persistent:!0}).onOk(async()=>{try{const{msg:s}=await c(t);s=="ok"&&a.notify({message:"\xA1Usuario eliminado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),p("onFire",!1)}catch(s){console.log(s)}})},C=t=>{d.push(`usuarios/edit/${t}`)};return(t,s)=>(u(),b("div",X,[e(S,{class:"my-card bg-white"},{default:l(()=>[i("div",Y,[e(D,{title:"Lista de Usuarios",rows:n(g),columns:r,"row-key":"name",filter:w.value},{"top-right":l(()=>[e(q,{borderless:"",dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=o=>w.value=o),placeholder:"Buscar",color:"indigo-6"},{append:l(()=>[e(O,{name:"search"})]),_:1},8,["modelValue"])]),body:l(o=>[e(R,{props:o},{default:l(()=>[e(h,{key:"nombre",props:o},{default:l(()=>[$(f(o.row.nombre),1)]),_:2},1032,["props"]),e(h,{key:"email",props:o},{default:l(()=>[$(f(o.row.email),1)]),_:2},1032,["props"]),e(h,{key:"img",props:o},{default:l(()=>[o.row.img?(u(),y(B,{key:1},{default:l(()=>[i("img",{src:o.row.img},null,8,ee)]),_:2},1024)):(u(),y(B,{key:0},{default:l(()=>[Z]),_:1}))]),_:2},1032,["props"]),e(h,{key:"rol",props:o},{default:l(()=>[e(H,{color:"grey-6"},{default:l(()=>[$(f(o.row.rol),1)]),_:2},1024)]),_:2},1032,["props"]),e(h,{key:"acciones",props:o},{default:l(()=>[e(x,{round:"",color:"orange-4",size:"sm",icon:"las la-edit",onClick:j=>C(o.row.uid)},null,8,["onClick"]),o.row.email!=="gonzaa.vidal.18@gmail.com"?(u(),y(x,{key:0,round:"",color:"red-4",size:"sm",icon:"las la-trash",class:"q-ml-xs",onClick:j=>V(o.row.uid)},null,8,["onClick"])):v("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"]),i("div",oe,[e(z,{showing:_.value,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])])]),_:1})]))}};const le={class:"q-gutter-md"},se={key:0,class:"q-mx-lg text-red-6 text-weight-bold"},re={key:1,class:"q-mx-lg text-red-6 text-weight-bold"},te={key:2,class:"q-mx-lg text-red-6 text-weight-bold"},ie={key:3,class:"q-mx-lg text-red-6 text-weight-bold"},ne={class:"row justify-end"},de={__name:"CrearUsuarioComponent",emits:["onFire"],setup(U,{emit:p}){const r=m({nombre:"",email:"",password:"",rol:""});let a=m({});const g=m(),c=I(),d=m(!1),_=W().shape({rol:Q().required("El rol es obligatorio."),password:Q().required("La contrase\xF1a es obligatoria."),email:Q().email("El email es inv\xE1lido.").required("El email es obligatorio."),nombre:Q().required("El nombre es obligatorio.")}),{createUsuario:w}=N(),V=async()=>{a.value={};try{await _.validate(r.value,{abortEarly:!1});try{d.value=!0,c.loadingBar.start();const{msg:t}=await w(r.value);t=="ok"&&(c.notify({message:"\xA1Usuario creado con \xE9xito!",color:"green-10",position:"top-right",icon:"lar la-check-circle"}),r.value={},g.value="",c.loadingBar.stop()),d.value=!1,p("onFire",!1)}catch(t){console.log(t)}}catch(t){t.inner.forEach(s=>{a.value[s.path]=s.message,g.value=a.value[s.path]})}},C=["ADMIN_ROLE","USER_ROLE"];return(t,s)=>(u(),b("div",le,[e(K,{class:"q-gutter-md",onSubmit:M(V,["prevent"])},{default:l(()=>[e(q,{filled:"",modelValue:r.value.nombre,"onUpdate:modelValue":s[0]||(s[0]=o=>r.value.nombre=o),label:"Nombre completo",color:"indigo-6",class:k({error:n(a).nombre})},null,8,["modelValue","class"]),n(a).nombre?(u(),b("span",se,f(n(a).nombre),1)):v("",!0),e(q,{filled:"",modelValue:r.value.email,"onUpdate:modelValue":s[1]||(s[1]=o=>r.value.email=o),label:"Correo electr\xF3nico",color:"indigo-6",class:k({error:n(a).email})},null,8,["modelValue","class"]),n(a).email?(u(),b("span",re,f(n(a).email),1)):v("",!0),e(q,{filled:"",modelValue:r.value.password,"onUpdate:modelValue":s[2]||(s[2]=o=>r.value.password=o),type:"password",label:"Contrase\xF1a",color:"indigo-6",class:k({error:n(a).password})},null,8,["modelValue","class"]),n(a).password?(u(),b("span",te,f(n(a).password),1)):v("",!0),e(J,{filled:"",modelValue:r.value.rol,"onUpdate:modelValue":s[3]||(s[3]=o=>r.value.rol=o),options:C,label:"Rol",color:"indigo-6",class:k({error:n(a).rol})},null,8,["modelValue","class"]),n(a).rol?(u(),b("span",ie,f(n(a).rol),1)):v("",!0),i("div",ne,[e(x,{type:"submit",color:"indigo-6",label:"Crear",class:"self-center q-ma-sm q-py-sm","icon-right":"las la-user-plus",loading:d.value},null,8,["loading"])])]),_:1},8,["onSubmit"])]))}};var ue=A(de,[["__scopeId","data-v-8c4ed696"]]);const ce={class:"q-pa-md q-gutter-sm text-indigo-6"},me={class:"row"},pe={class:"col-12 row q-pa-sm"},ge=i("div",{class:"col-6 text-indigo-6"},[i("span",{class:"text-h3 text-weight-bold"},"Usuarios")],-1),_e={class:"col-6 row justify-end"},fe={class:"row justify-center"},be=i("div",{class:"text-h5 col-8"},"Crear Usuario",-1),ve={class:"text-h5 col-4 row justify-end"},Ne={__name:"UsuariosView",setup(U){const p=m(!1),r=m(!0),a=m(!1),g=c=>{r.value=c,a.value=!0,setTimeout(()=>{r.value=!0},1e3),setTimeout(()=>{a.value=c},2e3)};return(c,d)=>(u(),y(P,{class:"q-pa-md bg-white"},{default:l(()=>[i("div",ce,[e(T,null,{default:l(()=>[e(E,{icon:"home",to:{name:"home"}}),e(E,{label:"Usuarios",icon:"las la-users"})]),_:1})]),i("div",me,[i("div",pe,[ge,i("div",_e,[e(x,{color:"indigo-6",icon:"las la-user-plus",onClick:d[0]||(d[0]=_=>p.value=!0),size:"md",rounded:""})])]),r.value?(u(),y(ae,{key:0,onOnFire:g})):v("",!0),i("div",fe,[e(z,{showing:a.value,label:"Espere un momento...","label-class":"text-indigo-6","label-style":"font-size: 1.1em"},null,8,["showing"])])]),e(G,{modelValue:p.value,"onUpdate:modelValue":d[2]||(d[2]=_=>p.value=_)},{default:l(()=>[e(S,{class:"q-dialog-plugin"},{default:l(()=>[e(F,{class:"row"},{default:l(()=>[be,i("div",ve,[e(x,{rounded:"",icon:"las la-times",size:"sm",onClick:d[1]||(d[1]=_=>p.value=!1),color:"indigo-6"})])]),_:1}),e(F,null,{default:l(()=>[e(ue,{onOnFire:g})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ne as default};
