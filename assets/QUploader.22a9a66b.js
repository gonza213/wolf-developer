import{p as Z,z as oe,aY as ne,A as le,r as z,m as T,ax as re,a3 as ue,aZ as ie,B as se,b5 as de,w as N,P as _,$ as I,V as W,ab as ce,h as V,am as fe,y as ve,D as he,a0 as me,q as ge,bn as pe,bo as ye}from"./index.a41ae495.js";import{u as be,v as $,a as Se,p as K,b as we,c as Te,r as X,s as Fe,d as Pe}from"./QMenu.43d920a2.js";import{c as Y}from"./selection.b7a6f271.js";var ze=Z({name:"QTooltip",inheritAttrs:!1,props:{...be,...oe,...ne,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:$},self:{type:String,default:"top middle",validator:$},offset:{type:Array,default:()=>[14,14],validator:Se},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...le],setup(e,{slots:y,emit:n,attrs:g}){let i,d;const F=ve(),{proxy:{$q:c}}=F,b=z(null),v=z(!1),B=T(()=>K(e.anchor,c.lang.rtl)),D=T(()=>K(e.self,c.lang.rtl)),k=T(()=>e.persistent!==!0),{registerTick:q,removeTick:t}=re(),{registerTimeout:l,removeTimeout:f}=ue(),{transition:o,transitionStyle:u}=ie(e,v),{localScrollTarget:O,changeScrollEvent:H,unconfigureScrollTarget:Q}=we(e,M),{anchorEl:s,canShow:P,anchorEvents:p}=Te({showing:v,configureAnchorEl:ee}),{show:R,hide:E}=se({showing:v,canShow:P,handleShow:x,handleHide:U,hideOnRouteChange:k,processOnMount:!0});Object.assign(p,{delayShow:G,delayHide:J});const{showPortal:A,hidePortal:a,renderPortal:S}=de(F,b,ae);if(c.platform.is.mobile===!0){const r={anchorEl:s,innerRef:b,onClickOutside(w){return E(w),w.target.classList.contains("q-dialog__backdrop")&&me(w),!0}},L=T(()=>e.modelValue===null&&e.persistent!==!0&&v.value===!0);N(L,w=>{(w===!0?Pe:X)(r)}),_(()=>{X(r)})}function x(r){t(),f(),A(),q(()=>{d=new MutationObserver(()=>C()),d.observe(b.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),C(),M()}),i===void 0&&(i=N(()=>c.screen.width+"|"+c.screen.height+"|"+e.self+"|"+e.anchor+"|"+c.lang.rtl,C)),l(()=>{A(!0),n("show",r)},e.transitionDuration)}function U(r){t(),f(),a(),h(),l(()=>{a(!0),n("hide",r)},e.transitionDuration)}function h(){d!==void 0&&(d.disconnect(),d=void 0),i!==void 0&&(i(),i=void 0),Q(),I(p,"tooltipTemp")}function C(){const r=b.value;s.value===null||!r||Fe({el:r,offset:e.offset,anchorEl:s.value,anchorOrigin:B.value,selfOrigin:D.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function G(r){if(c.platform.is.mobile===!0){Y(),document.body.classList.add("non-selectable");const L=s.value,w=["touchmove","touchcancel","touchend","click"].map(j=>[L,j,"delayHide","passiveCapture"]);W(p,"tooltipTemp",w)}l(()=>{R(r)},e.delay)}function J(r){f(),c.platform.is.mobile===!0&&(I(p,"tooltipTemp"),Y(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),l(()=>{E(r)},e.hideDelay)}function ee(){if(e.noParentEvent===!0||s.value===null)return;const r=c.platform.is.mobile===!0?[[s.value,"touchstart","delayShow","passive"]]:[[s.value,"mouseenter","delayShow","passive"],[s.value,"mouseleave","delayHide","passive"]];W(p,"anchor",r)}function M(){if(s.value!==null||e.scrollTarget!==void 0){O.value=ce(s.value,e.scrollTarget);const r=e.noParentEvent===!0?C:E;H(O.value,r)}}function te(){return v.value===!0?V("div",{...g,ref:b,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",g.class],style:[g.style,u.value],role:"complementary"},he(y.default)):null}function ae(){return V(fe,{name:o.value,appear:!0},te)}return _(h),Object.assign(F.proxy,{updatePosition:C}),S}}),ke=Z({name:"QUploaderAddTrigger",setup(){return ge(pe,()=>{console.error("QUploaderAddTrigger needs to be child of QUploader")})}});function m(e){return typeof e=="function"?e:()=>e}const Ee={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>e=>e.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},xe=["factory-failed","uploaded","failed","uploading"];function Ce({props:e,emit:y,helpers:n}){const g=z([]),i=z([]),d=z(0),F=T(()=>({url:m(e.url),method:m(e.method),headers:m(e.headers),formFields:m(e.formFields),fieldName:m(e.fieldName),withCredentials:m(e.withCredentials),sendRaw:m(e.sendRaw),batch:m(e.batch)})),c=T(()=>d.value>0),b=T(()=>i.value.length>0);let v;function B(){g.value.forEach(t=>{t.abort()}),i.value.length>0&&(v=!0)}function D(){const t=n.queuedFiles.value.slice(0);n.queuedFiles.value=[],F.value.batch(t)?k(t):t.forEach(l=>{k([l])})}function k(t){if(d.value++,typeof e.factory!="function"){q(t,{});return}const l=e.factory(t);if(!l)y("factory-failed",new Error("QUploader: factory() does not return properly"),t),d.value--;else if(typeof l.catch=="function"&&typeof l.then=="function"){i.value.push(l);const f=o=>{n.isAlive()===!0&&(i.value=i.value.filter(u=>u!==l),i.value.length===0&&(v=!1),n.queuedFiles.value=n.queuedFiles.value.concat(t),t.forEach(u=>{n.updateFileStatus(u,"failed")}),y("factory-failed",o,t),d.value--)};l.then(o=>{v===!0?f(new Error("Aborted")):n.isAlive()===!0&&(i.value=i.value.filter(u=>u!==l),q(t,o))}).catch(f)}else q(t,l||{})}function q(t,l){const f=new FormData,o=new XMLHttpRequest,u=(a,S)=>l[a]!==void 0?m(l[a])(S):F.value[a](S),O=u("url",t);if(!O){console.error("q-uploader: invalid or no URL specified"),d.value--;return}const H=u("formFields",t);H!==void 0&&H.forEach(a=>{f.append(a.name,a.value)});let Q=0,s=0,P=0,p=0,R;o.upload.addEventListener("progress",a=>{if(R===!0)return;const S=Math.min(p,a.loaded);n.uploadedSize.value+=S-P,P=S;let x=P-s;for(let U=Q;x>0&&U<t.length;U++){const h=t[U];if(x>h.size)x-=h.size,Q++,s+=h.size,n.updateFileStatus(h,"uploading",h.size);else{n.updateFileStatus(h,"uploading",x);return}}},!1),o.onreadystatechange=()=>{o.readyState<4||(o.status&&o.status<400?(n.uploadedFiles.value=n.uploadedFiles.value.concat(t),t.forEach(a=>{n.updateFileStatus(a,"uploaded")}),y("uploaded",{files:t,xhr:o})):(R=!0,n.uploadedSize.value-=P,n.queuedFiles.value=n.queuedFiles.value.concat(t),t.forEach(a=>{n.updateFileStatus(a,"failed")}),y("failed",{files:t,xhr:o})),d.value--,g.value=g.value.filter(a=>a!==o))},o.open(u("method",t),O),u("withCredentials",t)===!0&&(o.withCredentials=!0);const E=u("headers",t);E!==void 0&&E.forEach(a=>{o.setRequestHeader(a.name,a.value)});const A=u("sendRaw",t);t.forEach(a=>{n.updateFileStatus(a,"uploading",0),A!==!0&&f.append(u("fieldName",a),a,a.name),a.xhr=o,a.__abort=()=>{o.abort()},p+=a.size}),y("uploading",{files:t,xhr:o}),g.value.push(o),A===!0?o.send(new Blob(t)):o.send(f)}return{isUploading:c,isBusy:b,abort:B,upload:D}}var qe={name:"QUploader",props:Ee,emits:xe,injectPlugin:Ce},He=ye(qe);export{ze as Q,ke as a,He as b};
